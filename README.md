# Explore With Me (EWM) — Microservices Edition

## О проекте
Данный проект представляет собой переход от монолитной архитектуры к микросервисной. Основная цель — разделение ответственности между компонентами системы, обеспечение независимой масштабируемости и изоляция данных. Система предназначена для организации мероприятий, управления участием в них и взаимодействия между пользователями через систему комментариев.

---

## Архитектура системы

Система построена на стеке Spring Cloud и включает в себя следующие компоненты:

### Бизнес-сервисы
* **user-service** - управление учетными записями пользователей.
* **event-service** - управление жизненным циклом событий (создание, модерация, поиск).
* **request-service** - обработка заявок на участие и контроль лимитов участников.
* **comment-service** - функционал отзывов и обсуждений под событиями.
* **stats-service** - сервис сбора и агрегации статистики просмотров.

### Инфраструктурные компоненты
* **Gateway Server** - единая точка входа. Осуществляет маршрутизацию внешних HTTP-запросов к соответствующим сервисам.
* **Discovery Server (Netflix Eureka)** - обеспечивает механизм регистрации и обнаружения сервисов (Service Discovery).
* **Config Server** - централизованное хранилище конфигураций. Позволяет управлять настройками всех сервисов из единой точки (репозитория конфигураций).

Взаимодействие между сервисами реализовано через декларативный HTTP-клиент **OpenFeign**. Каждый сервис имеет выделенную базу данных в PostgreSQL, что исключает прямую зависимость на уровне хранения данных.

---

## Внутреннее API (Feign Clients)

Для обеспечения целостности данных микросервисы взаимодействуют по внутренним протоколам. Примеры ключевых операций:

* **Проверка зависимостей:** При создании комментария `comment-service` обращается к `user-service` и `event-service` для подтверждения существования авторов и событий.
* **Синхронизация участников:** `event-service` запрашивает у `request-service` актуальное количество подтвержденных заявок для корректного отображения лимитов.
* **Логирование активности:** Все сервисы являются поставщиками данных для `stats-service`, передавая информацию о посещении эндпоинтов.

---
## Технологический стек

- Java 21
- Spring Boot
- Spring Cloud (Eureka, Config Server, Gateway)
- OpenFeign
- Resilience4j
- PostgreSQL
- Docker, Docker Compose 
- Maven 

---
## Нефункциональные аспекты

- Отказоустойчивость: Circuit Breaker (Resilience4j)
- Централизованная конфигурация
- Изоляция данных
- Горизонтальное масштабирование сервисов

---
## Конфигурация и запуск


### Порядок запуска:
1. Запуск **Discovery Server**.
2. Запуск **Config Server**.
3. Запуск прикладных микросервисов и **Gateway Server**.

>Все параметры подключения, уровни логирования и настройки Resilience4j (Circuit Breaker) подгружаются динамически через Config Server.

---

## Внешние спецификации API

Проект полностью реализует требования API Yandex Practicum. Ознакомиться со спецификациями можно по ссылкам:
* [Основной сервис (Main Service)](https://raw.githubusercontent.com/yandex-praktikum/java-explore-with-me/main/ewm-main-service-spec.json)
* [Сервис статистики (Stats Service)](https://raw.githubusercontent.com/yandex-praktikum/java-explore-with-me/main/ewm-stats-service-spec.json)